import{D as B,s as u,K as U,c as r,a as e,t as o,z as n,I as f,F as x,G as T,P as $,L as y,O as C,M as j,H as A,o as i,p as g}from"./DJ5wksKX.js";import{u as N}from"./dQMjavNy.js";import"./DU5dWS6F.js";const q={class:"flex justify-between items-center mb-6"},z={class:"grid grid-cols-3 gap-4 mb-6"},E={class:"stat-card"},O={class:"stat-value text-emerald-400"},h={class:"stat-card"},I={class:"stat-value text-red-400"},P={class:"stat-card"},R={class:"card overflow-hidden"},G={class:"table"},H=["onClick"],K={key:0,class:"fixed inset-0 bg-black/70 flex items-center justify-center z-50"},J={class:"bg-slate-800 rounded-lg p-6 w-full max-w-md border border-slate-700"},Q=["value"],W={class:"flex justify-end gap-2 pt-4"},at=B({__name:"transactions",setup(X){const c=N(),d=u([]),p=u([]),w=u(!1),m=u(!1),l=u({date:new Date().toISOString().split("T")[0],transaction_type:null,amount:0}),D=g(()=>d.value.filter(a=>a.amount>0).reduce((a,t)=>a+t.amount,0)),_=g(()=>Math.abs(d.value.filter(a=>a.amount<0).reduce((a,t)=>a+t.amount,0))),k=g(()=>d.value.reduce((a,t)=>a+t.amount,0)),b=async()=>{w.value=!0;try{const[a,t]=await Promise.all([c.get("/transactions"),c.get("/transaction-types")]);d.value=a,p.value=t}catch(a){console.error("Failed to fetch data:",a)}finally{w.value=!1}},v=a=>`${(a/100).toFixed(2)} kr`,S=a=>new Date(a).toLocaleDateString("sv-SE"),L=a=>{if(!a)return"bg-slate-700 text-slate-300";const t=p.value.find(s=>s.id===a);return t?.name?.toLowerCase().includes("income")||t?.name?.toLowerCase().includes("sell")?"badge badge-success":"badge badge-danger"},M=a=>a&&p.value.find(t=>t.id===a)?.name||"Unknown",F=async()=>{try{await c.post("/transactions",l.value),m.value=!1,l.value={date:new Date().toISOString().split("T")[0],transaction_type:null,amount:0},await b()}catch(a){console.error("Failed to save transaction:",a)}},V=async a=>{if(confirm("Ta bort denna transaktion?"))try{await c.delete(`/transactions/${a}`),await b()}catch(t){console.error("Failed to delete transaction:",t)}};return U(b),(a,t)=>(i(),r("div",null,[e("div",q,[t[5]||(t[5]=e("h1",{class:"page-header"},"Transaktioner",-1)),e("button",{onClick:t[0]||(t[0]=s=>m.value=!0),class:"btn btn-primary"}," Lägg till transaktion ")]),e("div",z,[e("div",E,[t[6]||(t[6]=e("p",{class:"stat-label"},"Total inkomst",-1)),e("p",O,o(v(n(D))),1)]),e("div",h,[t[7]||(t[7]=e("p",{class:"stat-label"},"Total utgift",-1)),e("p",I,o(v(n(_))),1)]),e("div",P,[t[8]||(t[8]=e("p",{class:"stat-label"},"Netto",-1)),e("p",{class:f(n(k)>=0?"stat-value text-emerald-400":"stat-value text-red-400")},o(v(n(k))),3)])]),e("div",R,[e("table",G,[t[9]||(t[9]=e("thead",null,[e("tr",null,[e("th",null,"Datum"),e("th",null,"Typ"),e("th",null,"Belopp"),e("th")])],-1)),e("tbody",null,[(i(!0),r(x,null,T(n(d),s=>(i(),r("tr",{key:s.id},[e("td",null,o(S(s.date)),1),e("td",null,[e("span",{class:f(["badge",L(s.transaction_type)])},o(M(s.transaction_type)),3)]),e("td",{class:f(s.amount>=0?"text-emerald-400":"text-red-400")},o(v(s.amount)),3),e("td",null,[e("button",{onClick:Y=>V(s.id),class:"text-red-400 hover:text-red-300 text-sm"}," Ta bort ",8,H)])]))),128))])])]),n(m)?(i(),r("div",K,[e("div",J,[t[15]||(t[15]=e("h2",{class:"text-xl font-bold text-slate-100 mb-4"},"Lägg till transaktion",-1)),e("form",{onSubmit:$(F,["prevent"]),class:"space-y-4"},[e("div",null,[t[10]||(t[10]=e("label",{class:"label"},"Datum",-1)),y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n(l).date=s),type:"date",class:"input",required:""},null,512),[[C,n(l).date]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"label"},"Typ",-1)),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>n(l).transaction_type=s),class:"input",required:""},[t[11]||(t[11]=e("option",{value:""},"Välj typ...",-1)),(i(!0),r(x,null,T(n(p),s=>(i(),r("option",{key:s.id,value:s.id},o(s.name),9,Q))),128))],512),[[j,n(l).transaction_type]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"label"},"Belopp (öre, negativt för utgift)",-1)),y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>n(l).amount=s),type:"number",class:"input",required:""},null,512),[[C,n(l).amount,void 0,{number:!0}]])]),e("div",W,[e("button",{type:"button",onClick:t[4]||(t[4]=s=>m.value=!1),class:"btn btn-secondary"}," Avbryt "),t[14]||(t[14]=e("button",{type:"submit",class:"btn btn-primary"},"Lägg till",-1))])],32)])])):A("",!0)]))}});export{at as default};
