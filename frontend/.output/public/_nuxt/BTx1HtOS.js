import{T as E}from"./CGQrFPvo.js";import{u as F}from"./DPGkDMz_.js";import{C as V,J as B,c as i,a as s,t as a,y as o,F as b,E as h,r as y,o as d,S as L,H as P,n as r}from"./BEFdwPCg.js";import"./BMadXahP.js";const $={class:"grid grid-cols-4 gap-4 mb-6"},z={class:"stat-card"},K={class:"stat-value text-emerald-400"},N={class:"stat-card"},O={class:"stat-value"},R={class:"stat-card"},G={class:"stat-value"},H={class:"stat-card"},J={class:"stat-value"},M={class:"grid grid-cols-2 gap-6"},U={class:"card p-6"},q={class:"space-y-3"},I={class:"w-24 text-sm text-slate-400"},Q={class:"flex-1 bg-slate-700 rounded-full h-4 mx-2"},W={class:"w-8 text-sm font-medium"},X={class:"card p-6"},Y={class:"space-y-3"},Z={class:"flex justify-between"},ss={class:"font-medium text-slate-100"},ts={class:"flex justify-between"},ls={class:"font-medium text-red-400"},es={class:"flex justify-between"},as={class:"font-medium text-red-400"},os={class:"border-t border-slate-700 pt-2 flex justify-between"},ns={class:"font-bold text-emerald-400"},rs={class:"card p-6 mt-6"},cs={class:"table"},is={key:0,class:"text-slate-100"},ds={key:1,class:"text-slate-500"},us={class:"text-emerald-400 font-medium"},ps={class:"text-sm text-slate-400"},hs=V({__name:"analytics",setup(_s){const x=F(),p=y([]),g=y(!1),u=r(()=>p.value.filter(l=>l.status_id===5)),f=r(()=>p.value.filter(l=>l.status_id===3)),v=r(()=>u.value.reduce((l,t)=>{const e=(t.sell_price||0)+(t.sell_shipping_collected||0),c=t.buy_price+t.buy_shipping_cost,_=(t.sell_packaging_cost||0)+(t.sell_postage_cost||0);return l+(e-(c+_))},0)),k=r(()=>u.value.reduce((l,t)=>l+(t.sell_price||0)+(t.sell_shipping_collected||0),0)),m=r(()=>u.value.reduce((l,t)=>l+t.buy_price+t.buy_shipping_cost,0)),S=r(()=>u.value.reduce((l,t)=>l+(t.sell_packaging_cost||0)+(t.sell_postage_cost||0),0)),T=r(()=>f.value.reduce((l,t)=>l+t.buy_price+t.buy_shipping_cost,0)),w=r(()=>{const l={};return p.value.forEach(t=>{l[t.status_id]=(l[t.status_id]||0)+1}),l}),C=async()=>{g.value=!0;try{p.value=await x.get("/inventory")}catch(l){console.error("Failed to fetch data:",l)}finally{g.value=!1}},n=l=>`${(l/100).toFixed(2)} kr`,j=l=>new Date(l).toLocaleDateString("sv-SE"),A=l=>{const t=(l.sell_price||0)+(l.sell_shipping_collected||0),e=l.buy_price+l.buy_shipping_cost,c=(l.sell_packaging_cost||0)+(l.sell_postage_cost||0),_=t-(e+c);return`+${n(_)}`},D=l=>{const t=typeof l=="string"?parseInt(l):l;return{1:"bg-slate-500",2:"bg-sky-500",3:"bg-amber-500",4:"bg-purple-500",5:"bg-emerald-500"}[t]||"bg-slate-500"};return B(C),(l,t)=>(d(),i("div",null,[t[12]||(t[12]=s("h1",{class:"page-header"},"Analyser",-1)),s("div",$,[s("div",z,[t[0]||(t[0]=s("p",{class:"stat-label"},"Total vinst",-1)),s("p",K,a(n(o(v))),1)]),s("div",N,[t[1]||(t[1]=s("p",{class:"stat-label"},"Lager värde",-1)),s("p",O,a(n(o(T))),1)]),s("div",R,[t[2]||(t[2]=s("p",{class:"stat-label"},"Sålda artiklar",-1)),s("p",G,a(o(u).length),1)]),s("div",H,[t[3]||(t[3]=s("p",{class:"stat-label"},"Artiklar i lager",-1)),s("p",J,a(o(f).length),1)])]),s("div",M,[s("div",U,[t[4]||(t[4]=s("h2",{class:"section-title"},"Artiklar per status",-1)),s("div",q,[(d(!0),i(b,null,h(o(w),(e,c)=>(d(),i("div",{key:c,class:"flex items-center"},[s("span",I,a(o(E)[parseInt(c)]),1),s("div",Q,[s("div",{class:P(["h-full rounded-full transition-all",D(c)]),style:L({width:`${e/o(p).length*100}%`})},null,6)]),s("span",W,a(e),1)]))),128))])]),s("div",X,[t[9]||(t[9]=s("h2",{class:"section-title"},"Vinstfördelning (sålda artiklar)",-1)),s("div",Y,[s("div",Z,[t[5]||(t[5]=s("span",{class:"text-slate-400"},"Total intäkt",-1)),s("span",ss,a(n(o(k))),1)]),s("div",ts,[t[6]||(t[6]=s("span",{class:"text-slate-400"},"Kostnad för sålda varor",-1)),s("span",ls,"-"+a(n(o(m))),1)]),s("div",es,[t[7]||(t[7]=s("span",{class:"text-slate-400"},"Fraktkostnader",-1)),s("span",as,"-"+a(n(o(S))),1)]),s("div",os,[t[8]||(t[8]=s("span",{class:"font-bold text-slate-100"},"Nettoresultat",-1)),s("span",ns,a(n(o(v))),1)])])])]),s("div",rs,[t[11]||(t[11]=s("h2",{class:"section-title"},"Senaste försäljningar",-1)),s("table",cs,[t[10]||(t[10]=s("thead",null,[s("tr",null,[s("th",null,"Produkt"),s("th",null,"Köpris"),s("th",null,"Försäljningspris"),s("th",null,"Vinst"),s("th",null,"Såld datum")])],-1)),s("tbody",null,[(d(!0),i(b,null,h(o(u).slice(0,10),e=>(d(),i("tr",{key:e.id},[s("td",null,[e.product?(d(),i("span",is,a(e.product.brand)+" "+a(e.product.name),1)):(d(),i("span",ds,"Okänd"))]),s("td",null,a(n(e.buy_price+e.buy_shipping_cost)),1),s("td",null,a(e.sell_price?n(e.sell_price+(e.sell_shipping_collected||0)):"-"),1),s("td",us,a(A(e)),1),s("td",ps,a(e.sell_date?j(e.sell_date):"-"),1)]))),128))])])])]))}});export{hs as default};
